{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the CareerPilot AI platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "authProvider": {
          "type": "string",
          "description": "The authentication provider used by the user (e.g., Google, GitHub)."
        },
        "lastLogin": {
          "type": "string",
          "description": "Timestamp of the user's last login.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "authProvider",
        "lastLogin"
      ]
    },
    "Resume": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Resume",
      "type": "object",
      "description": "Represents a user's resume.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Resume entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Resume)"
        },
        "uploadDate": {
          "type": "string",
          "description": "The resume's uploaded date.",
          "format": "date-time"
        },
        "fileLocation": {
          "type": "string",
          "description": "The path to the resume file."
        },
        "atsScore": {
          "type": "number",
          "description": "The ATS score of this resume."
        },
        "improvementSuggestions": {
          "type": "string",
          "description": "AI-generated suggestions to improve the resume.",
          "format": "string"
        }
      },
      "required": [
        "id",
        "userId",
        "uploadDate",
        "fileLocation",
        "atsScore",
        "improvementSuggestions"
      ]
    },
    "InterviewSession": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InterviewSession",
      "type": "object",
      "description": "Represents an interview session conducted by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the InterviewSession entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N InterviewSession)"
        },
        "jobRole": {
          "type": "string",
          "description": "The job role selected for the interview."
        },
        "startTime": {
          "type": "string",
          "description": "Timestamp of when the interview session started.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "Timestamp of when the interview session ended.",
          "format": "date-time"
        },
        "questionIds": {
          "type": "array",
          "description": "References to InterviewQuestion. (Relationship: InterviewSession 1:N InterviewQuestion)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "userId",
        "jobRole",
        "startTime",
        "endTime",
        "questionIds"
      ]
    },
    "InterviewQuestion": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InterviewQuestion",
      "type": "object",
      "description": "Represents a question in an interview session.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the InterviewQuestion entity."
        },
        "interviewSessionId": {
          "type": "string",
          "description": "Reference to InterviewSession. (Relationship: InterviewSession 1:N InterviewQuestion)"
        },
        "questionText": {
          "type": "string",
          "description": "The text of the interview question."
        },
        "userAnswer": {
          "type": "string",
          "description": "The user's answer to the interview question."
        },
        "aiEvaluation": {
          "type": "string",
          "description": "AI evaluation of the user's answer."
        },
        "score": {
          "type": "number",
          "description": "Score assigned to the user's answer."
        },
        "modelAnswer": {
          "type": "string",
          "description": "A model answer for the interview question."
        }
      },
      "required": [
        "id",
        "interviewSessionId",
        "questionText",
        "userAnswer",
        "aiEvaluation",
        "score",
        "modelAnswer"
      ]
    },
    "SkillGapAnalysis": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SkillGapAnalysis",
      "type": "object",
      "description": "Represents the result of a skill-gap analysis.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the SkillGapAnalysis entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N SkillGapAnalysis)"
        },
        "missingSkills": {
          "type": "array",
          "description": "List of missing skills identified during the analysis.",
          "items": {
            "type": "string"
          }
        },
        "learningRoadmap": {
          "type": "array",
          "description": "A roadmap with resources",
          "items": {
            "type": "string"
          }
        },
        "analysisDate": {
          "type": "string",
          "description": "Timestamp of when the skill-gap analysis was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "missingSkills",
        "learningRoadmap",
        "analysisDate"
      ]
    },
    "JobDescriptionAnalysis": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "JobDescriptionAnalysis",
      "type": "object",
      "description": "Represents the analysis of a job description.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the JobDescriptionAnalysis entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N JobDescriptionAnalysis)"
        },
        "jobDescriptionText": {
          "type": "string",
          "description": "The text of the job description analyzed."
        },
        "requiredSkills": {
          "type": "array",
          "description": "List of required skills extracted from the job description.",
          "items": {
            "type": "string"
          }
        },
        "experienceLevel": {
          "type": "string",
          "description": "The experience level specified in the job description."
        },
        "keywords": {
          "type": "array",
          "description": "Keywords extracted from the job description.",
          "items": {
            "type": "string"
          }
        },
        "matchPercentage": {
          "type": "number",
          "description": "The percentage to the user's resume based on the analysis."
        },
        "missingKeywords": {
          "type": "array",
          "description": "Keywords missing from the user's resume.",
          "items": {
            "type": "string"
          }
        },
        "analysisDate": {
          "type": "string",
          "description": "Timestamp of when the job description analysis was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "jobDescriptionText",
        "requiredSkills",
        "experienceLevel",
        "keywords",
        "matchPercentage",
        "missingKeywords",
        "analysisDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "google.com",
      "github.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. Secured by user ID.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/resumes/{resumeId}",
        "definition": {
          "entityName": "Resume",
          "schema": {
            "$ref": "#/backend/entities/Resume"
          },
          "description": "Stores user resumes. Secured by user ID. The userId is denormalized into the resume document.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "resumeId",
              "description": "The unique identifier for the resume."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/interviewSessions/{interviewSessionId}",
        "definition": {
          "entityName": "InterviewSession",
          "schema": {
            "$ref": "#/backend/entities/InterviewSession"
          },
          "description": "Stores interview sessions conducted by the user. Secured by user ID. The userId is denormalized into the interviewSession document.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "interviewSessionId",
              "description": "The unique identifier for the interview session."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/interviewSessions/{interviewSessionId}/interviewQuestions/{interviewQuestionId}",
        "definition": {
          "entityName": "InterviewQuestion",
          "schema": {
            "$ref": "#/backend/entities/InterviewQuestion"
          },
          "description": "Stores individual interview questions within an interview session. Secured by user ID and interview session ID. The userId and interviewSessionId are denormalized into the interviewQuestion document.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "interviewSessionId",
              "description": "The unique identifier for the interview session."
            },
            {
              "name": "interviewQuestionId",
              "description": "The unique identifier for the interview question."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/skillGapAnalyses/{skillGapAnalysisId}",
        "definition": {
          "entityName": "SkillGapAnalysis",
          "schema": {
            "$ref": "#/backend/entities/SkillGapAnalysis"
          },
          "description": "Stores skill gap analysis results for the user. Secured by user ID. The userId is denormalized into the skillGapAnalysis document.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "skillGapAnalysisId",
              "description": "The unique identifier for the skill gap analysis."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/jobDescriptionAnalyses/{jobDescriptionAnalysisId}",
        "definition": {
          "entityName": "JobDescriptionAnalysis",
          "schema": {
            "$ref": "#/backend/entities/JobDescriptionAnalysis"
          },
          "description": "Stores job description analysis results for the user. Secured by user ID. The userId is denormalized into the jobDescriptionAnalysis document.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "jobDescriptionAnalysisId",
              "description": "The unique identifier for the job description analysis."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure Authorization Independence, DBAC, and support secure list operations (QAPs). User-owned data is structured under `/users/{userId}` for clear ownership. All collections are segregated to ensure homogeneous security posture.  Authorization independence is achieved by avoiding `get()` calls within the security rules. This is accomplished by structuring data in a way where access control can be determined solely based on the `request.auth.uid` and the path of the request, ensuring that security rules are atomic and easier to debug. By using path-based ownership, we leverage Firestore's built-in security features to define access control rules effectively. This approach is suitable for the CareerPilot AI platform to manage user resumes, interview sessions, skill gap analysis, and job description analysis."
  }
}