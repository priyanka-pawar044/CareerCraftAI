{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the CareerPilot AI platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "authProvider": {
          "type": "string",
          "description": "The authentication provider used by the user (e.g., Google, GitHub)."
        },
        "lastLogin": {
          "type": "string",
          "description": "Timestamp of the user's last login.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "authProvider",
        "lastLogin"
      ]
    },
    "Resume": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Resume",
      "type": "object",
      "description": "Represents a user's resume.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Resume entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Resume)"
        },
        "filename": {
          "type": "string",
          "description": "The name of the resume file."
        },
        "uploadDate": {
          "type": "string",
          "description": "Timestamp of when the resume was uploaded.",
          "format": "date-time"
        },
        "atsScore": {
          "type": "number",
          "description": "AI-generated ATS score for the resume (0-100)."
        },
        "improvementSuggestions": {
          "type": "string",
          "description": "AI-generated suggestions for improving the resume."
        },
        "resumeText": {
          "type": "string",
          "description": "Extracted text content of the resume."
        }
      },
      "required": [
        "id",
        "userId",
        "filename",
        "uploadDate",
        "atsScore",
        "improvementSuggestions",
        "resumeText"
      ]
    },
    "InterviewSession": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InterviewSession",
      "type": "object",
      "description": "Represents a mock interview session conducted by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the InterviewSession entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N InterviewSession)"
        },
        "jobRole": {
          "type": "string",
          "description": "The job role selected for the interview (e.g., Software Engineer)."
        },
        "startTime": {
          "type": "string",
          "description": "Timestamp of when the interview session started.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "Timestamp of when the interview session ended.",
          "format": "date-time"
        },
        "questionIds": {
          "type": "array",
          "description": "References to InterviewQuestion. (Relationship: InterviewSession 1:N InterviewQuestion)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "userId",
        "jobRole",
        "startTime",
        "endTime",
        "questionIds"
      ]
    },
    "InterviewQuestion": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InterviewQuestion",
      "type": "object",
      "description": "Represents a question asked during an interview session.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the InterviewQuestion entity."
        },
        "interviewSessionId": {
          "type": "string",
          "description": "Reference to InterviewSession. (Relationship: InterviewSession 1:N InterviewQuestion)"
        },
        "questionText": {
          "type": "string",
          "description": "The text of the interview question."
        },
        "userAnswer": {
          "type": "string",
          "description": "The user's answer to the question."
        },
        "correctnessScore": {
          "type": "number",
          "description": "AI-evaluated score for the correctness of the answer."
        },
        "clarityScore": {
          "type": "number",
          "description": "AI-evaluated score for the clarity of the answer."
        },
        "confidenceScore": {
          "type": "number",
          "description": "AI-evaluated score for the confidence demonstrated in the answer."
        },
        "modelAnswer": {
          "type": "string",
          "description": "AI-provided model answer to the question."
        },
        "improvementSuggestions": {
          "type": "string",
          "description": "AI-generated suggestions for improving the answer."
        }
      },
      "required": [
        "id",
        "interviewSessionId",
        "questionText",
        "userAnswer",
        "correctnessScore",
        "clarityScore",
        "confidenceScore",
        "modelAnswer",
        "improvementSuggestions"
      ]
    },
    "SkillGapAnalysis": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SkillGapAnalysis",
      "type": "object",
      "description": "Represents the result of a skill gap analysis.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the SkillGapAnalysis entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N SkillGapAnalysis)"
        },
        "missingSkills": {
          "type": "array",
          "description": "List of skills missing based on resume and job role requirements.",
          "items": {
            "type": "string"
          }
        },
        "learningRoadmap": {
          "type": "string",
          "description": "Personalized learning roadmap to acquire the missing skills."
        },
        "analysisDate": {
          "type": "string",
          "description": "Timestamp of when the skill gap analysis was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "missingSkills",
        "learningRoadmap",
        "analysisDate"
      ]
    },
    "JobDescriptionAnalysis": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "JobDescriptionAnalysis",
      "type": "object",
      "description": "Represents the analysis of a job description.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the JobDescriptionAnalysis entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N JobDescriptionAnalysis)"
        },
        "jobDescriptionText": {
          "type": "string",
          "description": "The text of the job description."
        },
        "requiredSkills": {
          "type": "array",
          "description": "List of required skills extracted from the job description.",
          "items": {
            "type": "string"
          }
        },
        "experienceLevel": {
          "type": "string",
          "description": "The experience level required for the job."
        },
        "resumeMatchPercentage": {
          "type": "number",
          "description": "Percentage indicating how well the user's resume matches the job description."
        },
        "missingKeywords": {
          "type": "array",
          "description": "List of keywords missing from the user's resume compared to the job description.",
          "items": {
            "type": "string"
          }
        },
        "analysisDate": {
          "type": "string",
          "description": "Timestamp of when the job description analysis was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "jobDescriptionText",
        "requiredSkills",
        "experienceLevel",
        "resumeMatchPercentage",
        "missingKeywords",
        "analysisDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. Only the authenticated user can read/write their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/resumes/{resumeId}",
        "definition": {
          "entityName": "Resume",
          "schema": {
            "$ref": "#/backend/entities/Resume"
          },
          "description": "Stores resume data for a specific user. Only the authenticated user can read/write their own resumes.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "resumeId",
              "description": "The unique identifier of the resume."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/interviewSessions/{interviewSessionId}",
        "definition": {
          "entityName": "InterviewSession",
          "schema": {
            "$ref": "#/backend/entities/InterviewSession"
          },
          "description": "Stores interview session data for a specific user. Only the authenticated user can read/write their own interview sessions.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "interviewSessionId",
              "description": "The unique identifier of the interview session."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/interviewSessions/{interviewSessionId}/interviewQuestions/{interviewQuestionId}",
        "definition": {
          "entityName": "InterviewQuestion",
          "schema": {
            "$ref": "#/backend/entities/InterviewQuestion"
          },
          "description": "Stores interview questions for a specific interview session of a user. Only the authenticated user can read/write their own interview questions within their interview sessions.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "interviewSessionId",
              "description": "The unique identifier of the interview session."
            },
            {
              "name": "interviewQuestionId",
              "description": "The unique identifier of the interview question."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/skillGapAnalyses/{skillGapAnalysisId}",
        "definition": {
          "entityName": "SkillGapAnalysis",
          "schema": {
            "$ref": "#/backend/entities/SkillGapAnalysis"
          },
          "description": "Stores skill gap analysis data for a specific user. Only the authenticated user can read/write their own skill gap analyses.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "skillGapAnalysisId",
              "description": "The unique identifier of the skill gap analysis."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/jobDescriptionAnalyses/{jobDescriptionAnalysisId}",
        "definition": {
          "entityName": "JobDescriptionAnalysis",
          "schema": {
            "$ref": "#/backend/entities/JobDescriptionAnalysis"
          },
          "description": "Stores job description analysis data for a specific user. Only the authenticated user can read/write their own job description analyses.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "jobDescriptionAnalysisId",
              "description": "The unique identifier of the job description analysis."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure authorization independence, clarity, and scalability. User-owned data is stored in hierarchical paths under the `/users/{userId}` collection, providing clear ownership. The membership map pattern is not used in this design, as the user data is accessed via secured paths. This design avoids `get()` calls in security rules, improving performance and security. Each path enforces specific access controls based on the authenticated user's ID. This structure supports QAPs by ensuring that list operations are always scoped to the current user's data, preventing unauthorized access to other users' data. By segregating data based on ownership, we ensure a homogeneous security posture within each collection."
  }
}